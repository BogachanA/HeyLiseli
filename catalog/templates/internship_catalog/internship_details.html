{% extends 'base.html' %}
{% load staticfiles %}
{% load compress %}

{% block head %}
<title>{{ internship }}</title>
{% compress css %}
<link rel="stylesheet" href="{% static 'base/css/internship_details.css' %}">
{% endcompress %}
{% endblock %}


{% block body %}
<div class="paraxify" id="mainImg"></div>
<div class="container-fluid" id="detailContainer">
    <div class="row justify-content-center">
        <div class="col-md-6 detailPanel" id="intInfo">
            <div class="detailSection" id="internshipHead">
                <div class="row justify-content-center">
                    <div class="forShadow">
                        <img id="intCoverImg" src="{{internship.cover_img.url}}">
                    </div>
                </div>
                <div class="row">
                    <div class="col-7">
                        <p id="intTitle" style="font-weight:bolder;">{{internship.name}}</p>
                    </div>
                    <div class="col-5">
                        <p id="companyTitle" class="text-right"> <span class="text-muted" style="font-weight:400">by </span>{{internship.provider}}</p>
                    </div>
                </div>
            </div>
            <div class="detailSection" id="companyBriefInfo">
                <img id="providerLogoSmall" src="{{internship.provider.company_logo.url}}">
                <div id="chevDown">
                    <i class="fa fa-chevron-down" aria-hidden="true" ></i>
                </div>
                <div id="companyDescription">
                    <span style="font-size:120%;"><strong>{{internship.provider}}</strong></span>
                    <span class="text-muted" style="font-size:85%;" id="company_desc">{{internship.provider.company_description}}</span>
                </div>
                <a href="{% url 'şirket_detay' internship.provider.id %}" id="toCompanyPage"><button class="btn btn-outline-warning" id="toComp">Şirket Sayfasına Git  <i class="fa fa-arrow-circle-o-right" aria-hidden="true"></i></button> </a>
            </div>
            <hr>
            <div class="detailSection" id="intDescription">
                <div class="modernTitle">
                    <h3>Staj Açıklaması</h3>
                </div>
                <p id="intDescriptionText" class="text-sm-left text-secondary">{{internship.description}}</p>
                <hr>
                <div class="modernTitle modernTitle2">
                    <h3 id="modTit2">Sorumluluklar / Gereklilikler</h3>
                </div>
                <p id="intRequirementText" class="text-right text-secondary">{{internship.requirements}}</p>
            </div>
            <hr>
            <div class="detailSection" id="intStats">
                <div class="row justify-content-center statRow">
                    <div class="col-4 stat" id="categoryStat">
                        <div class="toCenter">
                            <div class="centerTwo">
                                <i id="categoryI" class="fa fa-th-large fa-3x" aria-hidden="true"></i>
                            </div>
                            <div class="toggleTitles">
                                <p class="statName">Kategori</p>
                            </div>
                            <p class="statExp">{{internship.category}}</p>
                        </div>
                    </div>
                    <div class="col-4 stat" id="typeStat">
                        <div class="toCenter">
                            <div class="centerTwo">
                                <i id="clockI" class="fa fa-clock-o fa-3x" aria-hidden="true"></i>
                            </div>
                            <div class="toggleTitles">
                                <p class="statName">Staj Türü</p>
                            </div>
                            <p id="typeP" class="statExp">{{internship.get_type_display}}</p>

                        </div>
                    </div>
                    <div class="col-4 stat" id="locationStat">
                        <div class="toCenter">
                            <div class="centerTwo">
                                <i class="fa fa-map-marker fa-3x" aria-hidden="true"></i>
                            </div>
                            <div class="toggleTitles">
                                <p class="statName">Konum</p>
                            </div>
                            <p class="statExp">{{internship.location}}</p>

                        </div>
                    </div>
                </div>
                <div class="row justify-content-center statRow">
                    <div class="col-4 stat" id="categoryStat2">
                        <div class="toCenter">
                            <div class="centerTwo">
                                <i class="fa fa-calendar-o fa-3x" aria-hidden="true"></i>
                            </div>
                            <div class="toggleTitles">
                                <p class="statName">Yayın Tarihi</p>
                            </div>
                            <p class="statExp" id="publishDateInfo">{{internship.date_published}}</p>

                        </div>
                    </div>
                    <div class="col-4 stat" id="deadlineStat">
                        <div class="toCenter">
                            <div class="centerTwo">
                                <i id="crosshairs" class="fa fa-crosshairs fa-3x" aria-hidden="true"></i>
                            </div>
                            <div class="toggleTitles">
                                <p class="statName">Son Başvuru</p>
                            </div>
                            <p class="statExp" id="deadlineInfo">{{internship.deadline}}</p>

                        </div>
                    </div>
                    <div class="col-4 stat" id="timeframeStat">
                        <div class="toCenter">
                            <div class="centerTwo">
                                <i id="hourglass" class="fa fa-hourglass fa-2x" aria-hidden="true"></i>
                            </div>
                            <div class="toggleTitles">
                                <p class="statName">Staj Dönemi</p>
                            </div>
                            <p class="statExp">{{internship.time_frame}}</p>

                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4 detailPanel" id="similarInternships">

        </div>
    </div>
</div>
{% endblock %}

{% block script %}

<script type="text/javascript">
    $(function(){
        var initialBriefText=$("#company_desc").html();
        var briefText=$("#company_desc").html().substr(0,50)+" ...";
        var briefText=briefText.replace(/;st;/g,""),
            briefText=briefText.replace(/;st.;/g,""),
            briefText=briefText.replace(/;br;/g,"");
        $("#company_desc").html(briefText);

        editedBriefText=initialBriefText.replace(/;st;/g,"<strong>");
        editedBriefText=editedBriefText.replace(/;st.;/g,"</strong>");
        editedBriefText=editedBriefText.replace(/;br;/g,"<br>");
        editedBriefText=editedBriefText.replace(/--/g,"<br>-");
        editedBriefText="<br>"+editedBriefText;

        var toggler=true;
        $("#companyBriefInfo").click(function(){
            if(toggler==true){
                $("#company_desc").html(editedBriefText);
                var newHeight=($(this).css("height","auto").height()+70)+"px";

                $(this).css("height","85px");
                $(this).animate({height:newHeight});

                $("#chevDown").addClass("rotateable");
                $("#toCompanyPage").toggle();
                toggler=false;
            }
            else {
                $(this).animate({height:"85px"});
                $("#chevDown").removeClass("rotateable");
                setTimeout(function(){
                    $("#toCompanyPage").toggle();
                    $("#company_desc").html(briefText);
                },400);
                toggler=true;
            }
        });


        function splitIntoList(textToSplit){

            var sentences=textToSplit.split(".");
            var finalStringHTML="";
            for (var sent of sentences){
                var newSent=sent.replace("-","");
                finalStringHTML+=newSent+" <i class='fa fa-check-circle' style='color:var(--sblue);' aria-hidden='true'></i><br>";
            }
            finalStringHTML=finalStringHTML.substr(0,finalStringHTML.length-86);

            return finalStringHTML;
        }

        var splitIt=$("#intRequirementText").html(),
            splitIt=splitIt.replace(/;br;/g,"<br>"),
            splitIt=splitIt.replace(/;st;/g,"<strong>"),
            splitIt=splitIt.replace(/;st.;/g,"</strong>"),
            newHTML=splitIntoList(splitIt);
        $("#intRequirementText").html(newHTML);
        $("#intRequirementText").find("strong").css("font-weight","bold")
                                               .css("font-size","140%")
                                               .css("font-family","'Jockey One', sans-serif");
        var currDesc=$("#intDescriptionText").html(),
            currDesc=currDesc.replace(/;st;/g,"<strong>"),
            currDesc=currDesc.replace(/;st.;/g,"</strong>"),
            newDesc=currDesc.replace(/;br;/g,"<br>");
        $("#intDescriptionText").html(newDesc);



        function translateMonth(dateAsHTML){
            var splitted=dateAsHTML.split(" ");
            var translated="";
            switch(splitted[0]){
                case "Jan.":
                    translated="Ocak";
                    break;
                case "Feb.":
                    translated="Şubat";
                    break;
                case "March":
                    translated="Mart";
                    break;
                case "April":
                    translated="Nisan";
                    break;
                case "May":
                    translated="Mayıs";
                    break;
                case "June":
                    translated="Haziran";
                    break;
                case "July":
                    translated="Temmuz";
                    break;
                case "Aug.":
                    translated="Ağustos";
                    break;
                case "Sept.":
                    translated="Eylül";
                    break;
                case "Oct.":
                    translated="Ekim";
                    break;
                case "Nov.":
                    translated="Kasım";
                    break;
                case "Dec.":
                    translated="Aralık";
                    break;
            }
            return translated+" "+splitted[1]+" "+splitted[2];
        }

        var publishDateTranslate=$("#publishDateInfo").html();
        $("#publishDateInfo").html(translateMonth(publishDateTranslate));

        var deadlineTranslate=$("#deadlineInfo").html();
        $("#deadlineInfo").html(translateMonth(deadlineTranslate));


        $(".toCenter").hover(function(){
            $(this).find(".toggleTitles").stop(true,false).animate({height:"toggle"});
            $(this).find(".statExp").stop(true,false).animate({top:"0"});
        });
    });
</script>
{% endblock %}